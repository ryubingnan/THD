@{
    ViewData["Title"] = "案件一覧";
}

<div class="MyRoomAddDiv" style="margin-top:50px">
    <table>
        <tr>
            <td>案件名：</td>
            <td><input class="form-control" type="text" v-model="iptTitle" /></td>
            <td>契約形態：</td>
            <td>
                <el-select v-model="iptType" clearable>
                    <el-option v-for="item in selectOptions"
                               :key="item.value"
                               :label="item.label"
                               :value="item.value">
                    </el-option>
                </el-select>
            </td>
            <td>
                <input type="button" class="ic_shoulei hide_txt png btn btn-primary btn-lg btnShoppingCart" value="查询" @@click="handleGetItListInfos" />
                <input type="button" class="ic_shoulei hide_txt png btn btn-primary btn-lg btnShoppingCart" value="清空" @@click="handleClear" />
            </td>
        </tr>
    </table>
</div>
<div class="listTop">

    <table>
        <tbody v-for="(itListInfo, i) in itListInfos">
            <tr>
                <td colspan="6" style="text-align: left;">
                    <span style="border: 1px solid #666666; margin: 15px; font-size: 12px; color: #666666; padding: 2px; width: 30%;">案件名</span>{{itListInfo.title}}
                    <span style="border: 1px solid #666666; margin: 15px; font-size: 12px; color: #666666; padding: 2px; width: 30%;">契約期間</span>{{itListInfo.period}}
                    <span style="border: 1px solid #666666; margin: 15px; font-size: 12px; color: #666666; padding: 2px; width: 30%;">作業場所</span>{{itListInfo.area}}
                    <span style="border: 1px solid #666666; margin: 15px; font-size: 12px; color: #666666; padding: 2px; width: 30%;">契約形態</span>{{selectOptions.find(it=>it.value == itListInfo.type).label}}
                </td>
            </tr>
            <tr>
                <td colspan="5" style="padding-left: 10px; text-align: left;">{{itListInfo.type}}</td>
                <td style="text-align: center; width: 200px; vertical-align: middle;">
                    ￥<span id="ctl00_body_RepeaterAllListInfo_ctl00_Label2" style="color:#FF3300;font-size:36px;">{{itListInfo.price}}</span>元
                    <br>
                    <span>
                        <a :href="'/system/AddItListInfo/' + itListInfo.id">
                            <input type="button" class="btn btn-primary" value="编辑">
                        </a>
                    </span>
                    &nbsp;
                    <span>
                        <input type="button" class="btn btn-primary" @@click="handleDelete(itListInfo.id)" value="删除">
                    </span>
                </td>
            </tr>
        </tbody>
    </table>

    <table border="0">
        <tr>
            <td colspan="5" style="border-bottom:0px !important">
                <el-pagination v-model:current-page="pagination.pageIndex"
                               :page-sizes="[12, 24, 36]"
                               v-model:page-size="pagination.pageSize"
                               layout="total, sizes, prev, pager, next, jumper"
                               :total="pagination.totalCount"
                               @@size-change="handleGetItListInfos"
                               @@current-change="handleGetItListInfos">
                </el-pagination>
            </td>
        </tr>
    </table>
</div>


@section Scripts{

    <script>
        createVueApp({
            /*返回行程数据*/
            data() {
                return {
                    itListInfos: [],
                    pagination: {
                        pageIndex: 1,
                        pageSize: 12,
                        totalCount: 0,
                    },
                    iptTitle: '',
                    iptType: '',
                    selectOptions: [
                        {
                            value: '1',
                            label: '業務委託（準委任）'
                        }, {
                            value: '2',
                            label: '業務委託（請負）'
                        }, {
                            value: '3',
                            label: '派遣契約'
                        }, {
                            value: '4',
                            label: 'その他'
                        }
                    ],
                }
            },
            /*页面加载完成后回调下方的行程列表方法*/
            mounted() {
                this.handleGetItListInfos();
            },
            /*获取行程列表*/
            methods: {
                handleGetItListInfos() {
                    this.pagination.Title = this.iptTitle
                    this.pagination.Type = this.iptType
                    this.getItListInfos(this.pagination).then(res => {
                        this.itListInfos = res.items
                        this.pagination.totalCount = res.totalCount
                    })
                },
                /*发送请求*/
                getItListInfos(pagination) {
                    return this.$http.post('/System/GetItListInfoList', pagination)
                },
                handleClear() {
                    this.iptTitle = ''
                    this.iptType = ''
                },
                handleDelete(id) {
                    this.$http.post('/system/deleteItListInfo', id).then(res => {
                        if (res) {
                            this.handleGetItListInfos()
                        } else {
                            this.$message({
                                message: '删除失败',
                                type: 'error'
                            });
                        }
                    })
                }
            }
        })

    </script>
}
